---
title: 'ccxcéƒ¨ç½²å°ç™½æ•™ç¨‹ï¼ˆè¸©å‘è®°å½•ï¼‰'
updated: 2026-02-20
published: 2025-09-17
description: 'æœ¬äººåœ¨CCXC-Engineéƒ¨ç½²è¿‡ç¨‹ä¸­è¸©çš„å‘ä»¥åŠéƒ¨ç½²ccxcå¼•æ“çš„å°ç™½å‘æ•™ç¨‹'
image: /assets/posts/ccxc_banner_43A5FE1EFD6504FBDCE67A1079D35A18.png
category: æŒ‡å—
draft: false
tags:
- å¼€æº
- CCBC
- PuzzleHunt
---

CCXCæ˜¯ä¸ªéå¸¸å¥½çš„PuzzleHuntåå°å¼•æ“ï¼Œè¿™ç¯‡æ–‡ç« ä¼šæ•™å­¦å¦‚ä½•ä»0å¼€å§‹éƒ¨ç½²ä¸€ä¸ªç§æœ‰åŒ–çš„CCXCå¼•æ“ï¼Œå½“ç„¶æ‚¨ä¹Ÿå¯ä»¥æŸ¥çœ‹ï¼š[å®˜æ–¹éƒ¨ç½²æ–‡æ¡£](https://engine.ccbcarchive.com/guide/deployment.html)

:::caution[æ³¨æ„ï¼ï¼ï¼]
2025.10.20 37eabccæ›´æ–°äº†ä¸€ä¸ªæœ‰å…³ç”¨æˆ·å¤šåœ°ç™»å½•çš„bugï¼Œå¦‚æœªæ›´æ–°å»ºè®®æ›´æ–°ï¼    
2026.01.29 fdf46bc[é€’äº¤äº†ä¸€ä¸ªæœ‰å…³éªŒè¯ç é‡æ”¾çš„ä¿®å¤ï¼Œå»ºè®®æ›´æ–°ï¼ï¼ˆPRé“¾æ¥ï¼‰](https://github.com/cipherpuzzles/ccxc-backend/pull/1)
:::

:::warning[åŠé€€æé†’ï¼]
å‰æ’æé†’ï¼Œccxcçš„è®¾è®¡éå¸¸ç²¾å¦™ï¼Œå¯¹äºæ™®é€šhuntéœ€è¦å®šåˆ¶å¾ˆå¤šçš„å†…å®¹ï¼Œå¦‚æœä½ è¦åŠhuntä½†æ˜¯ç²¾åŠ›ä¸è¶³å»ºè®®ä½¿ç”¨[P&KU Website](https://github.com/PKUPC/pnku-website).åŒæ—¶æˆ‘æœ‰ç©ºçš„è¯ä¹Ÿå¯ä»¥æ‰¾æˆ‘**å…è´¹**å¸®å¿™ï¼ˆä»…é™éæœŸæœ«å‘¨ï¼ŒæœŸæœ«å‘¨å¤ªå¿™äº†å¿ƒæœ‰ä½™è€ŒåŠ›ä¸è¶³TATï¼‰     
**æ³¨ï¼šå¦‚æœæ—¶é—´ç´§è¿«ï¼Œï¼ˆæ ¹æ®æœ¬äººä½“éªŒä¸»è§‚æ’åï¼‰éƒ¨ç½²å®¹æ˜“åº¦&é€Ÿåº¦ å…¬ä¼—å·>P&KU Website>CCXCï¼›**     
ç›¸å¯¹çš„ï¼Œä½“éªŒæ•ˆæœä¸ŠCCXCä¼šæ›´å¥½ã€‚
:::

:::tip[å¹¿å‘Šï¼ˆ]
æˆ‘ä»¬æ­£åœ¨ç­¹å»ºä¸€ä¸ªé¢„è®¡äº(å·²è·³ç¥¨å¾ˆä¹…)çš„CCBCçš„fanmadeèµ›äº‹ï¼Œå¦‚æœæ‚¨æœ‰å…´è¶£åŠ å…¥å‡ºé¢˜ç»„æˆ–è€…å†…æµ‹ç»„ï¼Œäº¦æˆ–è€…æ‚¨æœ‰ç¾å·¥æˆ–è€…è®¾è®¡æ–¹é¢çš„æ‰èƒ½ï¼Œæ¬¢è¿æ‚¨åŠ å…¥ï¼ç¾¤å·ï¼š[1061359082(ç‚¹å‡»åŠ ç¾¤)](https://qm.qq.com/q/wBLBM1kY9M)
:::

## ç¡¬ä»¶å‡†å¤‡

- ä¸€å°æœåŠ¡å™¨

- ä¸€ä¸ªåŸŸåï¼ˆè‡ªå·±ä½“éªŒçš„è¯ä¹Ÿå¯ä»¥æ²¡æœ‰ï¼‰

:::important[é‡è¦æé†’]
æ¨èä½¿ç”¨å¤§é™†å¤–çš„ **Ubuntu 24.04 LTS** æœåŠ¡å™¨ã€‚    
å¦‚æœæ²¡æœ‰æœåŠ¡å™¨ï¼Œä½¿ç”¨è‡ªå·±çš„ç”µè„‘ä¹Ÿå¯ä»¥ã€‚ä½¿ç”¨å›½å†…æœåŠ¡å™¨çš„è¯ï¼Œè¯·ç¡®ä¿åŸŸåå·²ç»å¤‡æ¡ˆã€‚ä½¿ç”¨è‡ªå·±çš„åŸŸåçš„è¯è¯·åŠ¡å¿…ç¡®ä¿**åŸŸåèƒ½æ­£ç¡®è®¿é—®åˆ°ä½ çš„æœåŠ¡å™¨**ï¼Œå¹¶ä¸”80å’Œ443ç«¯å£æ­£å¸¸å¼€æ”¾
:::

:::caution[å¿…éœ€ï¼]
å¦‚æœä½ æ²¡æœ‰è‡ªå·±çš„åŸŸåï¼Œè¯·æ³¨æ„ä½ åªèƒ½åœ¨æœåŠ¡å™¨ä¸Šè®¿é—®ä½“éªŒCCXCå¼•æ“ï¼Œå¦‚æœä½ æƒ³ç»™åˆ«äººç”¨æˆ–è€…æ­å»ºæœåŠ¡å™¨è¯·è‡ªå¤‡åŸŸåï¼      
å³ä½¿ä½ æ‹¥æœ‰åŸŸåï¼Œä½ ä¹Ÿéœ€è¦ç¡®ä¿ä½ çš„æœåŠ¡å™¨æœ‰å…¬ç½‘IPï¼å¦‚æœä½ ä¸çŸ¥é“ä½ çš„æœåŠ¡å™¨æœ‰æ²¡æœ‰ï¼Œè¯·ä½ è¯¢é—®æœåŠ¡å™¨ä¾›åº”å•†ï¼
:::

### åŸŸåé…ç½®

**å¦‚æœä½ æ²¡æœ‰åŸŸåè¯·è·³è¿‡ï¼**

```
yourdomain.com          -> ä½ çš„æœåŠ¡å™¨ IP
api.yourdomain.com      -> ä½ çš„æœåŠ¡å™¨ IP
static.yourdomain.com   -> ä½ çš„æœåŠ¡å™¨ IP
admin.yourdomain.com    -> ä½ çš„æœåŠ¡å™¨ IP
puzzle.yourdomain.com   -> ä½ çš„æœåŠ¡å™¨ IP
```

å°†ä»¥ä¸ŠDNSè®°å½•æ·»åŠ åˆ°ä½ çš„åŸŸåä¸­ï¼Œå°†`yourdomain.com`æ›¿æ¢ä¸ºä½ è‡ªå·±çš„åŸŸåã€‚[å¦‚ä½•æ·»åŠ DNSè®°å½•ï¼Ÿ](https://toolshu.com/baidu?%E5%9F%9F%E5%90%8D%E6%B7%BB%E5%8A%A0DNS%E8%AE%B0%E5%BD%95)

### è¯ä¹¦ç”³è¯·

å¦‚æœä½ éœ€è¦è‡ªåŠ¨åŒ–æ›´æ–°è¯ä¹¦ï¼Œæ¨èå®‰è£…`certbot`ã€‚    
```bash
sudo apt update
sudo apt install certbot python3-certbot-nginx
```

ç”³è¯·è¯ä¹¦ï¼ˆæ— cdnæƒ…å†µï¼‰
```bash
# ä¸ºæ‰€æœ‰å­åŸŸåç”³è¯·è¯ä¹¦ï¼Œéœ€è¦æŠŠ"yourdomain.com"æ›¿æ¢ä¸ºä½ è‡ªå·±çš„åŸŸå
sudo certbot --nginx -d yourdomain.com -d api.yourdomain.com -d static.yourdomain.com -d admin.yourdomain.com -d puzzle.yourdomain.com
```


<details>
<summary>DNS-01æ–¹å¼ç”³è¯·</summary>

DNS-01 éªŒè¯æ–¹å¼ç›¸æ¯” HTTP-01 æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- âœ… **æ”¯æŒæ³›åŸŸåè¯ä¹¦**ï¼ˆ*.example.comï¼‰
- âœ… **æ— éœ€å¼€æ”¾80ç«¯å£**ï¼Œé€‚åˆå†…ç½‘æœåŠ¡å™¨
- âœ… **ä¸å—é˜²ç«å¢™é™åˆ¶**
- âœ… **éªŒè¯æ›´å¯é **

**è·å– Cloudflare API Tokenï¼š**

1. ç™»å½• Cloudflare æ§åˆ¶å°
2. è¿›å…¥ **My Profile** â†’ **API Tokens**
3. ç‚¹å‡» **Create Token**ï¼Œé€‰æ‹© **Create Custom Token**
4. é…ç½®æƒé™ï¼š
   ```
   Zone â†’ DNS â†’ Edit
   Zone â†’ Zone â†’ Read
   ```
5. é€‰æ‹©éœ€è¦æ“ä½œçš„åŸŸååŒºåŸŸ
6. ç‚¹å‡» **Continue to summary** â†’ **Create Token**
7. **âš ï¸ é‡è¦**ï¼šå¤åˆ¶å¹¶å®‰å…¨ä¿å­˜ Tokenï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼‰

```bash
# å®‰è£… Certbot å’Œ Cloudflare æ’ä»¶
sudo apt install certbot python3-certbot-dns-cloudflare -y
```

åˆ›å»ºå‡­è¯æ–‡ä»¶

```bash
# åˆ›å»ºé…ç½®ç›®å½•
sudo mkdir -p /etc/letsencrypt/cloudflare

# åˆ›å»ºå‡­è¯æ–‡ä»¶
sudo nano /etc/letsencrypt/cloudflare/cloudflare.ini
```

å¡«å†™å‡­è¯å†…å®¹ï¼š

```ini
# Cloudflare API Token
dns_cloudflare_api_token = YOUR_API_TOKEN_HERE
```

> âš ï¸ **æ›¿æ¢ `YOUR_API_TOKEN_HERE` ä¸ºä½ ä¹‹å‰è·å–çš„ API Token**

è®¾ç½®æ–‡ä»¶æƒé™ï¼ˆé‡è¦ï¼ï¼‰

```bash
# è®¾ç½®ä¸¥æ ¼çš„æ–‡ä»¶æƒé™ï¼Œé˜²æ­¢æ³„éœ²
sudo chmod 600 /etc/letsencrypt/cloudflare/cloudflare.ini
sudo chown root:root /etc/letsencrypt/cloudflare/cloudflare.ini
```

ç”³è¯·å•åŸŸåè¯ä¹¦

```bash
sudo certbot certonly \
  --dns-cloudflare \
  --dns-cloudflare-credentials /etc/letsencrypt/cloudflare/cloudflare.ini \
  -d example.com \
  -d www.example.com
```

æˆ–è€…ï¼šä½ å¯ä»¥ç”³è¯·æ³›åŸŸåè¯ä¹¦

```bash
sudo certbot certonly \
  --dns-cloudflare \
  --dns-cloudflare-credentials /etc/letsencrypt/cloudflare/cloudflare.ini \
  -d example.com \
  -d *.example.com
```
</details>

**è‡ªåŠ¨ç»­æœŸ**

Let's Encrypt è¯ä¹¦æœ‰æ•ˆæœŸä¸º **90å¤©**ï¼ŒCertbot æ”¯æŒè‡ªåŠ¨ç»­æœŸã€‚

æµ‹è¯•è‡ªåŠ¨ç»­æœŸ:

```bash
sudo certbot renew --dry-run
```

## ç¯å¢ƒæ­å»º

ä½ å¿…é¡»å®‰è£…å¹¶é…ç½®ä»¥ä¸‹ç»„ä»¶ï¼š

- git
- node.js *v22.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬*
- .NET 8.0 *è¿è¡Œæ—¶æˆ–SDK*
- è‡³å°‘ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ *ä¾‹å¦‚nanoæˆ–è€…vim*
- MariaDB
- Redis
- mkcert

ä½ æœ€å¥½å®‰è£…å¹¶é…ç½®ä»¥ä¸‹ç»„ä»¶ï¼š*(è¿™äº›ç»„ä»¶æ˜¯éƒ¨ç½²æœåŠ¡å™¨æ‰éœ€è¦çš„)*

- PM2
- Nginx
- Prometheus
- Prometheus Node Exporter

### åŸºæœ¬ç¯å¢ƒæ­å»º

> [!TIPS]
> å¦‚æœä½ æ˜¯Windowsç”¨æˆ·è¯·è‡ªè¡Œä¸‹è½½å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š
>
> - [Git Bash](https://gitforwindows.org/)
> - [Node.js v22.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬](https://nodejs.org/en/download/)
> - [.NET 8.0 è¿è¡Œæ—¶æˆ–SDK](https://dotnet.microsoft.com/en-us/download/dotnet/8.0)
> - [MariaDB for Windows](https://mariadb.com/downloads/)
> - [Redis Windows](https://developer.aliyun.com/article/1395346)

```bash
sudo apt update && sudo apt upgrade -y
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt install -y nodejs
sudo apt install -y git
wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
rm packages-microsoft-prod.deb
sudo apt update
sudo apt install -y apt-transport-https
sudo apt update
sudo apt install -y dotnet-sdk-8.0
sudo npm install -g pm2
pm2 --version
```

è¯·æŠŠä¸Šé¢çš„ä»£ç ä¸€è¡Œä¸€è¡Œé»è´´åˆ°æœåŠ¡å™¨æ§åˆ¶å°çš„ç»ˆç«¯éƒ¨åˆ†,å¦‚æœè¦æ±‚è¾“å…¥å¯†ç è¯·è¾“å…¥å½“å‰è´¦å·çš„å¯†ç ã€‚è¾“å…¥å¯†ç æ—¶ä¸ä¼šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œè¯·ä½ ä»”ç»†è¾“å…¥ã€‚

### æ•°æ®åº“å®‰è£…ä¸é…ç½®

```bash
sudo apt install -y mariadb-server
sudo systemctl start mariadb
sudo systemctl enable mariadb
sudo mysql_secure_installation
```

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼

è¿è¡Œæœ€åä¸€è¡Œä¹‹åä¼šè·³å‡ºè¿™æ ·çš„æ–‡å­—ï¼Œã€ã€‘å†…æ˜¯ä½ éœ€è¦è¾“å…¥çš„æ–‡æœ¬ï¼Œè¾“å…¥å®Œä¹‹åè®°å¾—æŒ‰å›è½¦ï¼Œwindowsä¸‹ä¹Ÿæ˜¯å·®ä¸å¤šçš„ï¼Œä¸»è¦æ˜¯å…³æ‰å¤§éƒ¨åˆ†ä¸å¿…è¦ç”šè‡³ä¼šå¯¼è‡´åç«¯è¿è¡Œä¸èµ·æ¥çš„å®‰å…¨é€‰é¡¹ã€‚

```
NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MariaDB to secure it, we'll need the current
password for the root user. If you've just installed MariaDB, and
haven't set the root password yet, you should just press enter here.

Enter current password for root (enter for none): ã€ä½ çš„rootå¯†ç ï¼Œä¸çŸ¥é“çš„è¯å»æ‰¾æœåŠ¡å™¨å‚å•†å®¢æœå’¨è¯¢ã€‘
OK, successfully used password, moving on...

Setting the root password or using the unix_socket ensures that nobody
can log into the MariaDB root user without the proper authorisation.

You already have your root account protected, so you can safely answer 'n'.

Switch to unix_socket authentication [Y/n] ã€nã€‘
 ... skipping.

You already have your root account protected, so you can safely answer 'n'.

Change the root password? [Y/n] ã€nã€‘
 ... skipping.

By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] ã€nã€‘
 ... skipping.

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] ã€nã€‘
 ... skipping.

By default, MariaDB comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] ã€nã€‘
 ... skipping.

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] ã€Yã€‘
 ... Success!

Cleaning up...

All done!  If you've completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
```

æ¥ä¸‹æ¥å°±æ˜¯æ•°æ®åº“åˆå§‹åŒ–æ­¥éª¤.

```bash
mysql -u root -p
```

```mysql
CREATE DATABASE ccxc_prod CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'ccxc_user'@'localhost' IDENTIFIED BY 'ï¼ï¼è¿™é‡Œå¡«ä¸€ä¸ªå¯†ç ï¼ï¼';
```

æ³¨æ„æŠŠ`ï¼ï¼è¿™é‡Œå¡«ä¸€ä¸ªå¯†ç ï¼ï¼`æ¢æˆä½ è‡ªå·±çš„å¯†ç ï¼Œä¸è¦è¾“å…¥ä¸­æ–‡

```mysql
GRANT ALL PRIVILEGES ON ccxc_prod.* TO 'ccxc_user'@'localhost';
GRANT SELECT ON information_schema.* TO 'ccxc_user'@'localhost';
```

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼è¾“å…¥ä¸Šé¢ç¬¬äºŒè¡Œå¯èƒ½ä¼šæœ‰æŠ¥é”™ï¼Œä¸ç”¨ç®¡ï¼

```mysql
FLUSH PRIVILEGES;
EXIT;
```

æ­å–œï¼Œä½ çš„MariaDBå·²ç»é…ç½®å®Œæ¯•äº†ï¼

### ç¼“å­˜å®‰è£…ä¸é…ç½®

```bash
sudo apt install -y redis-server
sudo systemctl start redis-server
sudo systemctl enable redis-server
```

æ¥ä¸‹æ¥è¾“å…¥`redis-cli ping`,å¦‚æœä½ çœ‹åˆ°ä¸€ä¸ª`PONG`,å°±æ˜¯å®‰è£…æˆåŠŸäº†ï¼æ­å–œï¼

### nginxå®‰è£…ä¸é…ç½®

```bash
sudo apt install -y nginx
sudo systemctl start nginx
sudo systemctl enable nginx
sudo mkdir -p /var/www/static
sudo mkdir -p /var/www/ccxc/{admin,website,puzzle}
sudo chown -R www-data:www-data /var/www/
```

## å¯åŠ¨ä¸»åç«¯

> [!WARNING]
> è™½ç„¶ç›´æ¥ä½¿ç”¨å®˜æ–¹ä»“åº“æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯å»ºè®®è‡ªå·±cloneä¸€ä¸ªï¼Œæ–¹ä¾¿è‡ªå·±ä¿®æ”¹ã€‚cloneä¹‹åä½ åªéœ€è¦åœ¨ä½ çš„ç”µè„‘ä¸Šå®‰è£…gitå°±èƒ½å‡ è¡Œå‘½ä»¤æ›´æ–°æœåŠ¡ç«¯ï¼Œéå¸¸æ–¹ä¾¿ï¼è®°å¾—ä¿®æ”¹gité“¾æ¥å“¦ï¼ä»¥åŠgitè´¦å·ç›¸å…³é…ç½®åœ¨æ­¤å¤„ä¸èµ˜è¿°ï¼Œè¯·è‡ªè¡Œæœç´¢ã€‚

```bash
sudo mkdir -p /opt/ccxc-backend
cd /opt/ccxc-backend

sudo git clone https://github.com/cipherpuzzles/ccxc-backend.git src
cd src
```

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼å¦‚æœä½ æ˜¯è‡ªå®šä¹‰åŸŸåï¼Œä½ éœ€è¦ç¼–è¾‘`/opt/ccxc-backend/src/ccxc-backend/Config/SystemConfig.cs`å¹¶æ›¿æ¢å¦‚ä¸‹ç½‘å€`public string ProjectFrontendPrefix { get; set; } = "https://www.ccxc.ikp.yt:13880";`ä¸ºä½ çš„åŸŸåï¼Œä¸ç„¶åˆ°åé¢ç®¡ç†é¢æ¿æ— æ³•æ‹‰èµ·ç™»å½•ï¼

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼å¦‚æœä½ æ˜¯è‡ªå®šä¹‰åŸŸåï¼Œä½ éœ€è¦ç¼–è¾‘`/opt/ccxc-backend/src/ccxc-backend/Controllers/Users/SsoController.cs`å¹¶æ›¿æ¢ç¬¬41è¡Œifæ¡ä»¶ï¼š`host.EndsWith("cipherpuzzles.com", StringComparison.OrdinalIgnoreCase)`ä¸­çš„ç½‘å€ä¸ºä½ çš„åŸŸåï¼Œä¸ç„¶åˆ°åé¢ç®¡ç†é¢æ¿ç™»å½•è¿”å›400æ— æ³•ç™»å½•ï¼

```bash
sudo dotnet publish --configuration Release --runtime linux-x64 --self-contained false --output /opt/ccxc-backend/app

sudo chown -R www-data:www-data /opt/ccxc-backend
sudo chmod +x /opt/ccxc-backend/app/ccxc-backend
```

ç¼–è¾‘`/opt/ccxc-backend/Config/ccxc.config.toml`ï¼ˆå¦‚æœä¸å­˜åœ¨çš„è¯å°±æ˜¯`/opt/ccxc-backend/app/Config/ccxc.config.toml`ï¼‰:

```toml
[Config/CcxcConfig]
HttpPort = "52412"
RedisConnStr = "127.0.0.1:6379"
DbConnStr = "Server=localhost;User=ccxc_user;Database=ccxc_prod;Port=3306;Password=ï¼ï¼è¿™é‡Œå¡«ä¹‹å‰æ•°æ®åº“é‚£ä¸ªå¯†ç ï¼ï¼;Charset=utf8mb4;ConvertZeroDateTime=True"
DebugMode = "False"
ImageStorage = "/var/www/static/images/"
ImagePrefix = "https://static.yourdomain.com/images/"
PassHashKey1 = "ï¼ï¼è¿™é‡Œå¡«ä¸€ä¸ª20å­—ç¬¦é•¿åº¦çš„è„¸æ»šé”®ç›˜å­—ç¬¦ä¸²ï¼ï¼"
PassHashKey2 = "ï¼ï¼è¿™é‡Œå¡«ä¸€ä¸ª20å­—ç¬¦é•¿åº¦çš„è„¸æ»šé”®ç›˜å­—ç¬¦ä¸²ï¼ï¼"
AESMasterKey = "ï¼ï¼è¿™é‡Œå¡«ä¸€ä¸ª32å­—ç¬¦é•¿åº¦çš„è„¸æ»šé”®ç›˜å­—ç¬¦ä¸²ï¼ï¼"
# ä¸‹é¢é‚£ä¸ªé‚®ä»¶éªŒè¯çš„é€‰é¡¹å…³é—­åæ³¨å†Œçš„æ—¶å€™ä¸ä¼šå‘é€é‚®ä»¶ï¼Œä½†æ˜¯å…³æ‰ä¹‹åå°±æ²¡æ³•é‡ç½®å¯†ç äº†
EnableEmailVerify = "True"
AliyunDmAccessKey = "ï¼ï¼è¿™é‡Œå¡«é˜¿é‡Œäº‘AccessKeyï¼ï¼"
AliyunDmAccessSecret = "ï¼ï¼è¿™é‡Œå¡«é˜¿é‡Œäº‘AccessSecretï¼ï¼"
```
[è„¸æ»šé”®ç›˜å­—ç¬¦ç”Ÿæˆå™¨](https://www.lddgo.net/string/randompassword)æ’é™¤å­—ç¬¦å¡«`"\`,è®¾ç½®å¥½é•¿åº¦ç›´æ¥å¤åˆ¶è¿›æ¥æ›¿æ¢å°±è¡Œ

æœ‰å…³é‚®ä»¶éªŒè¯éªŒè¯é…ç½®é¡¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å¾€ä¸‹ç¿»åˆ°ç³»ç»Ÿåˆå§‹åŒ–ç¯èŠ‚ã€‚

é˜¿é‡Œäº‘é‚®ä»¶æ¨é€è¦æ±‚ä½ æ‹¥æœ‰ä¸€ä¸ªåŸŸåï¼Œæ‰€ä»¥å¦‚æœä½ æ²¡æœ‰çš„è¯å¯ä»¥ä¸å¡«ï¼Œåé¢ä¼šæ•™æ€ä¹ˆç»•é‚®ä»¶æ¿€æ´»ã€‚

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼ä½ éœ€è¦ç¼–è¾‘`/opt/ccxc-backend/app/ccxc.service`:

```ini
[Unit]
Description=Ccxc Backend

[Service]
ExecStart=/opt/ccxc-backend/app/ccxc-backend
Restart=always
Environment=PATH=/usr/bin:/usr/local/bin:/usr/local/node/bin
WorkingDirectory=/opt/ccxc-backend/

[Install]
WantedBy=multi-user.target
```

æ¥ä¸‹æ¥ä½ éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
sudo cp /opt/ccxc-backend/app/ccxc.service /etc/systemd/system/

sudo systemctl daemon-reload
sudo systemctl enable ccxc
sudo systemctl start ccxc

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status ccxc
```

å¦‚æœå‡ºç°ç±»ä¼¼è¿™æ ·çš„å°±æ˜¯æˆåŠŸäº†ï¼š

```
â— ccxc.service - Ccxc Backend
     Loaded: loaded (/etc/systemd/system/ccxc.service; enabled; vendor preset: enabled)
     Active: active (running) since Wed 2025-09-01 08:00:00 UTC; 114h ago
   Main PID: 114514 (ccxc-backend)
      Tasks: 69 (limit: 1145)
     Memory: 114.5M
        CPU: 1min 15.514s
     CGroup: /system.slice/ccxc.service
             â””â”€114514 /opt/ccxc-backend/app/ccxc-backend
```

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼å¦‚æœæ²¡è¿è¡Œèµ·æ¥ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯æ•°æ®åº“è¿ä¸ä¸Š *(æŠ¥é”™çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„)* ï¼š

```
[1   ] 2025-09-04 19:58:31 ,096 INFO - æ­£åœ¨åˆå§‹åŒ–æ•°æ®åº“ã€‚ 
Unhanded exception . Sqlsugar . Sq 1 sugarException :ä¸­æ–‡æç¤º:è¿æ¥æ•°æ®åº“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯,æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸ï¼šccxc_user '@' localhost ' to database ' mysql' DbType =" MySql"; ConfigId =""; Access denied for user 'ccxc_user'@'localhost' English Message : Connection open error Access denied for user to database ' my at sqlsugar . check . Exception ( Boo 1 ean isException , String message , String [] args ) 
```

è¿™æ—¶å€™ä½ è¦é‡æ–°ç¼–è¾‘`/opt/ccxc-backend/Config/ccxc.config.toml`ï¼ŒæŠŠæ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²æ¢æˆrootç”¨æˆ·å’Œrootå¯†ç ã€‚

å¦‚æœä½ ç”¨rootç”¨æˆ·åœ¨æ§åˆ¶å°è¾“å…¥`mysql -u ccxc_user -p`ç„¶åè¾“å…¥å¯†ç è¿›ä¸å»æ•°æ®åº“æ“ä½œç•Œé¢å¤§æ¦‚ç‡æ˜¯ä½ å¯†ç å¤åˆ¶é”™äº†ã€‚

å¦‚æœä½ ç”¨rootç”¨æˆ·åœ¨æ§åˆ¶å°è¾“å…¥`mysql -u root -p`ç„¶åè¾“å…¥æ•°æ®åº“rootå¯†ç è¿›ä¸å»æ•°æ®åº“æ“ä½œç•Œé¢å¤§æ¦‚ç‡æ˜¯æ•°æ®åº“å®‰è£…è¿‡ç¨‹é…ç½®é”™äº†ã€‚

å¦‚æœä½ ç”¨rootç”¨æˆ·åœ¨æ§åˆ¶å°è¾“å…¥`mysql -u root`è¿›ä¸å»æ•°æ®åº“æ“ä½œç•Œé¢å¤§æ¦‚ç‡æ˜¯è¦é‡è£…æ•°æ®åº“äº†ã€‚ä¸è¿‡ç›®å‰æ¥è¯´è¿˜æ˜¯ç›´æ¥é‡è£…ç³»ç»Ÿæœ€æ–¹ä¾¿ï¼ˆï¼‰

æ’æŸ¥é¡ºåºï¼š ccxc_userç™»å½• > rootç™»å½• > mariadbé…ç½® > é‡è£…æ•°æ®åº“

## åŒæ­¥æœåŠ¡å™¨ã€å‰ç«¯éƒ¨ç½²

è¿™å‡ æ­¥åªéœ€è¦è·Ÿç€å®˜æ–¹æ–‡æ¡£æ¥å°±è¡Œï¼éå¸¸ç®€å•ï¼

- [å®˜æ–¹éƒ¨ç½²æ–‡æ¡£](https://engine.ccbcarchive.com/guide/deployment.html)

## ç³»ç»Ÿåˆå§‹åŒ–

> [!WARNING]
> è¿™ä¸€æ­¥å…¨æ˜¯å‘ï¼ï¼ï¼ï¼ï¼

> [!WARNING]
> è¿™ä¸€æ­¥å…¨æ˜¯å‘ï¼ï¼ï¼ï¼ï¼

> [!WARNING]
> è¿™ä¸€æ­¥å…¨æ˜¯å‘ï¼ï¼ï¼ï¼ï¼

é¦–å…ˆï¼Œä½ éœ€è¦æ³¨å†Œä¸»ç«™ï¼Œæ³¨å†Œå®Œéœ€è¦ä½ éªŒè¯é‚®ä»¶ï¼Œä½†æ˜¯ä½ æ²¡æœ‰é˜¿é‡Œäº‘AccessKeyæˆ–è€…æ˜¾ç¤ºé‚®ä»¶å‘é€é”™è¯¯ï¼Œè¿™æ—¶å€™ä½ å°±éœ€è¦æ•°æ®åº“æ¿€æ´»ã€‚

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼é˜¿é‡Œäº‘AccessKeyå¡«å†™æ­£ç¡®ä¹‹åå‘ä¸å‡ºé‚®ä»¶ï¼Œåç«¯æ˜¾ç¤º`Aliyun.Acs.Core.Exceptions.ClientException: InvalidMailAddress.NotFound : The specified mailAddress does not exist.`è¯·æ³¨æ„éœ€è¦ä½¿ç”¨**æ–°åŠ æŠ«ç«™ç‚¹**çš„å‘ä»¶é‚®ç®±! åœ¨DMæ§åˆ¶å°å·¦ä¸Šè§’ä¸‹æ‹‰æ¡†æ”¹æˆæ–°åŠ å¡é‡æ–°é…ç½®å‘ä»¶åŸŸåå’Œå‘ä»¶åœ°å€ï¼

<details>
<summary>å¯¹äº2025.10.1 bbfd901å‰çš„ç‰ˆæœ¬</summary>

### ç»•é‚®ä»¶æ¿€æ´»/åˆå§‹åŒ–ç®¡ç†

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼ä¸¤ä¸ªæ“ä½œæ˜¯ä¸€æ ·çš„ï¼æ— è®ºä½ æœ‰æ²¡æœ‰æ¿€æ´»é‚®ç®±éƒ½å¾—è¿™ä¹ˆå¹²

```bash
mysql -u root -p
```

ç„¶åä¼šå‡ºæ¥ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¾“å…¥æ•°æ®åº“rootå¯†ç ã€‚

æ¥ä¸‹æ¥ï¼š
```mysql
use ccxc_prod
SELECT * from user;
UPDATE user SET roleid = 5 WHERE email = '<ä½ æ³¨å†Œä½¿ç”¨çš„é‚®ç®±>';
```

å®Œæ•´æ“ä½œç¤ºä¾‹å¦‚ä¸‹ï¼š

```
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 70
Server version: 10.6.22-MariaDB-0ubuntu0.22.04.1 Ubuntu 22.04

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]> use ccxc_prod
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [ccxc_prod]> SELECT * from user;
+-----+--------------+------------------------------+--------------------------+-------+------------------------------+--------+----------------------------+----------------------------+-----------------------------------------------------------+------------------------------------------------------------------+-------------+--------+------------+
| uid | username     | email                        | hashkey                  | phone | password                     | roleid | update_time                | create_time                | profile                                                   | info_key                                                         | theme_color | gender | third_pron |
+-----+--------------+------------------------------+--------------------------+-------+------------------------------+--------+----------------------------+----------------------------+-----------------------------------------------------------+------------------------------------------------------------------+-------------+--------+------------+
|   1 | etetill      | eterill@hotmail.com          | **************************** | NULL  | **************************** |      0 | 2025-09-17 08:46:00.441015 | 2025-09-12 14:51:14.093171 | äººæœ‰äº”åï¼Œä»£ä»·æœ‰ä¸‰ï¼Œå­˜ä¹‹æœ‰å››ï¼Œå…±é¥®æ— æœŸ                    | ******************************************************** | #0fe6d8     |      0 | NULL       |
+-----+--------------+------------------------------+--------------------------+-------+------------------------------+--------+----------------------------+----------------------------+-----------------------------------------------------------+------------------------------------------------------------------+-------------+--------+------------+
6 rows in set (0.001 sec)

MariaDB [ccxc_prod]> UPDATE user SET roleid = 5 WHERE email = 'eterill@hotmail.com';
Query OK, 1 rows affected (0.002 sec)
Rows matched: 1  Changed: 1  Warnings: 0

MariaDB [ccxc_prod]> COMMIT;
Query OK, 0 rows affected (0.000 sec)

MariaDB [ccxc_prod]> SELECT * from user;
+-----+--------------+------------------------------+--------------------------+-------+------------------------------+--------+----------------------------+----------------------------+-----------------------------------------------------------+------------------------------------------------------------------+-------------+--------+------------+
| uid | username     | email                        | hashkey                  | phone | password                     | roleid | update_time                | create_time                | profile                                                   | info_key                                                         | theme_color | gender | third_pron |
+-----+--------------+------------------------------+--------------------------+-------+------------------------------+--------+----------------------------+----------------------------+-----------------------------------------------------------+------------------------------------------------------------------+-------------+--------+------------+
|   1 | etetill      | eterill@hotmail.com          | **************************** | NULL  | **************************** |      5 | 2025-09-17 08:46:00.441015 | 2025-09-12 14:51:14.093171 | äººæœ‰äº”åï¼Œä»£ä»·æœ‰ä¸‰ï¼Œå­˜ä¹‹æœ‰å››ï¼Œå…±é¥®æ— æœŸ                    | ******************************************************** | #0fe6d8     |      0 | NULL       |
+-----+--------------+------------------------------+--------------------------+-------+------------------------------+--------+----------------------------+----------------------------+-----------------------------------------------------------+------------------------------------------------------------------+-------------+--------+------------+
6 rows in set (0.001 sec)

MariaDB [ccxc_prod]> EXIT;
Bye

```

ç°åœ¨å›åˆ°ä¸»ç«™ç™»å½•ï¼Œå‘ç°å·²ç»æ˜¯ç®¡ç†å‘˜äº†ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£è¯´æ˜è¿›å…¥åå°ä¿®æ”¹å…¶ä»–å­—æ®µå°±è¡Œäº†ã€‚ **å¦‚æœæç¤ºssoé”™è¯¯æˆ–è€…å…¶ä»–æŠ¥é”™å°±é€€å‡ºç™»å½•ä¹‹åé‡æ–°ç™»å½•ä¸€æ¬¡ï¼**

</details>

### åˆå§‹åŒ–ç®¡ç†

è¿™ä¸€éƒ¨åˆ†é€‚ç”¨äº**2025.10.1 bbfd901**ä¹‹åç‰ˆæœ¬çš„ccxc-backendã€‚å¦‚æœä½ çš„åç«¯æ˜¯å¾ˆæ—©ä¹‹å‰cloneçš„é‚£å»ºè®®ç”¨ä¸Šé¢æŠ˜å å¿«é‡Œçš„æ–¹æ³•æˆ–è€…æ›´æ–°ä»“åº“ã€‚

å¦‚æœä¸Šé¢çš„æ­¥éª¤ä½ éƒ½åšå¯¹äº†ï¼Œé‚£ä¹ˆä½ å¯ä»¥å…ˆæ³¨å†Œä¸ªè´¦å·ï¼Œç„¶åè¾“å…¥`/opt/ccxc-backend/app/ccxc-backend initadmin`,æ¥ç€è¾“å…¥å¯¹åº”çš„uidå³å¯ **ï¼ˆä¸€èˆ¬æ˜¯1ï¼‰** ã€‚ä¸è¿‡å³ä½¿è¿™æ ·ä½ ä¹Ÿé€ƒä¸è¿‡ä¿®æ”¹åç«¯çš„å‘½è¿TAT

#### å…³äºé‚®ä»¶æ¿€æ´»çš„é…ç½®é¡¹

æ³¨æ„ï¼šå¦‚æœå…³é—­äº†é‚®ä»¶éªŒè¯ï¼Œé‡ç½®å¯†ç ä¼šè¢«ç¦ç”¨ï¼Œå°±ä¼šæ— æ³•é‡ç½®å¯†ç ã€‚æ‰€ä»¥åœ¨ä½ ç¬¬ä¸€æ¬¡æ³¨å†Œçš„æ—¶å€™å¯ä»¥å…³é—­ï¼Œä½†æ˜¯åç»­å»ºè®®è¿˜æ˜¯å¼€å›æ¥ã€‚

æ— è®ºæ€ä¹ˆæ ·ç»‘å®šé‚®ä»¶æ˜¯æ— å¯é¿å…çš„ï¼Œå¦‚æœä½ è¦åŠhuntå»ºè®®è¿˜æ˜¯æä¸€ä¸ªAccessKeyå§ã€‚


## é˜²ç«å¢™é…ç½®

é˜²ç«å¢™æ˜¯æä¸ºé‡è¦çš„ä¸€ç¯ï¼Œä¸è£…é˜²ç«å¢™ä½ çš„æœåŠ¡å™¨ä¸å‡ºå‡ å¤©å°±å¾—å‡ºäº‹

å¤§å¤šæ•°Ubuntuç³»ç»Ÿå·²é¢„è£…UFWã€‚è‹¥æœªå®‰è£…ï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š

```bash
sudo apt update
sudo apt install ufw
```

UFWé»˜è®¤å…è®¸æ‰€æœ‰å‡ºç«™æµé‡å¹¶æ‹’ç»æ‰€æœ‰å…¥ç«™æµé‡ã€‚ä¸ºå®ç°å®Œå…¨çš„â€œé»˜è®¤æ‹’ç»â€ï¼Œéœ€æ˜¾å¼è®¾ç½®å…¥ç«™å’Œå‡ºç«™ç­–ç•¥ï¼š

```bash
#å…è®¸SSHï¼ˆç«¯å£22ï¼‰å…¥ç«™ï¼š
sudo ufw allow 22
#ä½ éœ€è¦æ³¨æ„è‡ªå·±sshè¿æ¥æ—¶ç”¨çš„å“ªä¸ªç«¯å£ï¼Œä¸€å®šè¦ç¡®è®¤å¥½ï¼è¦ä¸ç„¶ä½ çš„æœåŠ¡å™¨å°±åªèƒ½æƒ³åŠæ³•ç‰©ç†ç™»å½•äº†ï¼ï¼ï¼

#å…è®¸HTTPï¼ˆç«¯å£80ï¼‰å…¥ç«™ï¼š
sudo ufw allow 80
#å…è®¸HTTPSï¼ˆç«¯å£443ï¼‰å…¥ç«™ï¼š
sudo ufw allow 443

#å¯¹æ•æ„Ÿç«¯å£åŠ å¼ºé˜²æŠ¤ï¼š
sudo ufw deny 6379
sudo ufw deny 3306
sudo ufw deny 9090

#é»˜è®¤é˜»æ­¢å…¥ç«™
sudo ufw default deny incoming
sudo ufw default deny outgoing
```

å¯ç”¨UFWé˜²ç«å¢™ï¼š(è¯·ä½ ç¡®ä¿ä¹‹å‰é…ç½®æ­£ç¡®ï¼è¿™æ˜¯æœ€åä¸€æ¬¡åæ‚”æœºä¼šï¼å¦‚æœä½ ä¸å°å¿ƒå…³äº†sshç«¯å£å°±åªèƒ½ç‰©ç†è¿æ¥äº†ï¼)
```bash
sudo ufw enable

#ç¡®è®¤é˜²ç«å¢™çŠ¶æ€
sudo ufw status
```

æ­£ç¡®é…ç½®çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š

```
root@ppbjsxb# ufw status
Status: active

To                         Action      From
--                         ------      ----
22                         ALLOW       Anywhere
6379                       DENY        Anywhere
3306                       DENY        Anywhere
80                         ALLOW       Anywhere
443                        ALLOW       Anywhere
9090                       DENY        Anywhere
22 (v6)                    ALLOW       Anywhere (v6)
6379 (v6)                  DENY        Anywhere (v6)
3306 (v6)                  DENY        Anywhere (v6)
80 (v6)                    ALLOW       Anywhere (v6)
443 (v6)                   ALLOW       Anywhere (v6)
9090 (v6)                  DENY        Anywhere (v6)
```

### ğŸ‘ğŸ’¯ğŸ‘æ­å–œï¼ä½ å·²ç»å®Œæˆäº†åŸºæœ¬éƒ¨ç½²ï¼

## è¾…åŠ©æœåŠ¡éƒ¨ç½²

### ç³»ç»Ÿç›‘æµ‹

> [!WARNING]
> è¿™ä¸€æ­¥æœ‰å‘ï¼ï¼ï¼windowsæ²¡æœ‰è¢«å®˜æ–¹æ”¯æŒï¼Œæ‰€ä»¥ä¸å»ºè®®å®‰è£…

ä¸Šæ–‡æåˆ°æ¨èå®‰è£…Prometheusï¼Œå°±æ˜¯ä¸ºç³»ç»Ÿç›‘æµ‹æœåŠ¡çš„ã€‚

ä½ éœ€è¦å‰å¾€[ä¸‹è½½é¡µé¢](https://prometheus.io/download/)ï¼Œç„¶åä¸‹è½½Prometheuså’Œnode_exporterçš„å¯¹åº”ç‰ˆæœ¬ã€‚ä½ æ˜¯linux(Ubuntuä¹Ÿç®—linux)å°±é€‰linuxï¼Œmacå°±é€‰darwinã€‚å³é”®å¤åˆ¶ä¸‹è½½é“¾æ¥ï¼Œä¸€å…±æœ‰ä¸¤ä¸ªã€‚

```bash
cd /opt
wget -c https://github.com/prometheus/prometheus/releases/download/v3.5.0/prometheus-3.5.0.linux-amd64.tar.gz
wget -c https://github.com/prometheus/node_exporter/releases/download/v1.9.1/node_exporter-1.9.1.linux-amd64.tar.gz
```

æŠŠé“¾æ¥æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ï¼Œå®åœ¨ä¸ä¼šå¼„ç›´æ¥å¤åˆ¶æˆ‘ç»™å‡ºæ¥çš„ä¹Ÿå¯ã€‚

```bash
tar -xzvf prometheus-3.5.0.linux-amd64.tar.gz
tar -xzvf node_exporter-1.9.1.linux-amd64.tar.gz
mv ./prometheus-3.5.0.linux-amd64 /opt/prometheus
mv ./node_exporter-1.9.1.linux-amd64 /opt/node_exporter
```

ç¼–è¾‘Prometheusçš„é…ç½®`/opt/prometheus/prometheus.yml`ï¼š

```yaml
global:
  scrape_interval: 15s
  scrape_timeout: 10s
  scrape_protocols:
  - OpenMetricsText1.0.0
  - OpenMetricsText0.0.1
  - PrometheusText1.0.0
  - PrometheusText0.0.4
  evaluation_interval: 15s
runtime:
  gogc: 75
alerting:
  alertmanagers:
  - follow_redirects: true
    enable_http2: true
    scheme: http
    timeout: 10s
    api_version: v2
    static_configs:
    - targets: []
scrape_configs:
- job_name: prometheus
  static_configs:
  - targets:
    - localhost:9090
    labels:
      app: prometheus
- job_name: node_exporter
  static_configs:
  - targets:
    - localhost:9100
    labels:
      app: node_exporter
otlp:
  translation_strategy: UnderscoreEscapingWithSuffixes
```

ä½ å¯ä»¥é€šè¿‡è°ƒæ•´`scrape_interval`æ¥ä¿®æ”¹é‡‡æ ·é—´éš”ã€‚ä¿å®ˆä¸€ç‚¹å¯ä»¥æ˜¯10s-15sï¼Œæç«¯ä¸€ç‚¹1800séƒ½æ˜¯å¯ä»¥çš„ã€‚å€¼è¶Šå°é—´éš”è¶ŠçŸ­ï¼Œç›¸å¯¹çš„ï¼Œç©ºé—´å ç”¨ä¹Ÿä¼šæ›´é«˜ã€‚

å®Œæˆä¹‹åï¼Œä½ éœ€è¦æŠŠè¿™ä¸¤ä¸ªç¨‹åºæ·»åŠ åˆ°ç³»ç»ŸæœåŠ¡ï¼ˆå½“ç„¶ä¸æ˜¯å¿…é¡»ï¼‰

ç¼–è¾‘`prometheus.service`:

```ini
[Unit]
Description=Prometheus
After=network.target

[Service]
Type=simple
User=root
ExecStart=/opt/prometheus/prometheus --web.listen-address=:9090 --config.file=/opt/prometheus/prometheus.yml
Restart=always

[Install]
WantedBy=multi-user.target
```

ç¼–è¾‘`node_exporter.service`:

```ini
[Unit]
Description=Prometheus Node Exporter
After=network.target

[Service]
Type=simple
User=root
ExecStart=/opt/node_exporter/node_exporter
Restart=always

[Install]
WantedBy=multi-user.target
```

```bash
sudo cp /opt/prometheus.service /etc/systemd/system/
sudo cp /opt/node_exporter.service /etc/systemd/system/

sudo systemctl daemon-reload
sudo systemctl start prometheus
sudo systemctl enable prometheus
sudo systemctl start node_exporter
sudo systemctl enable node_exporter
```

å†æ¬¡ç¼–è¾‘åç«¯çš„é…ç½®æ–‡ä»¶`/opt/ccxc-backend/app/Config/ccxc.config.toml`:

```toml
# å¡«å†™ Prometheus APIåœ°å€ç”¨äºå±•ç¤ºæ€§èƒ½ç›‘æ§ã€‚ä¸å¡«æ—¶ä¸ºä¸å¯ç”¨ã€‚è¯·ç¡®ä¿Prometheuså·²æ­£ç¡®å®‰è£…ã€‚ä¾‹å­ï¼šhttp://localhost:9090
PrometheusApi = "http://localhost:9090"
```

ç„¶åæ‰‹åŠ¨é‡å¯åç«¯ï¼š

```bash
sudo systemctl restart ccxc
```

ç™»å½•ç®¡ç†åå°ï¼Œå‘ç°èµ„æºç›‘æ§å·²ç»æˆåŠŸæ˜¾ç¤ºäº†ã€‚

### ğŸ‘ğŸ’¯ğŸ‘æ­å–œï¼ä½ å·²ç»å®Œæˆäº†é™¤äº†é¢˜ç›®ä»¥å¤–çš„å…¨éƒ¨ç»„ä»¶çš„éƒ¨ç½²ï¼

## å…¶ä»–ç»†èŠ‚ï¼

### å‰åç«¯æ›´æ–°

#### å‰ç«¯æ›´æ–°

ç®¡ç†åå°

```bash
cd /tmp/ccxc-builds/admin
git pull
npm install
npm run build
sudo cp -r dist/* /var/www/ccxc/admin/
```

ç½‘ç«™å‰ç«¯

```bash
cd /tmp/ccxc-builds/website
git pull
npm install
npm run build
sudo cp -r dist/* /var/www/ccxc/website/
```

è°œé¢˜å‰ç«¯

```bash
cd /tmp/ccxc-builds/puzzle
git pull
npm install
npm run build
sudo cp -r dist/* /var/www/ccxc/puzzle/
```

#### åç«¯æ›´æ–°

```bash
cd /opt/ccxc-backend/src
sudo systemctl stop ccxc
sudo git pull
sudo dotnet publish --configuration Release --runtime linux-x64 --self-contained false --output /opt/ccxc-backend/app
sudo systemctl restart ccxc
```

> å¦‚ä½ æ‰€è§ï¼Œgit pullä¹‹åä¼šå¯¼è‡´é…ç½®æ–‡ä»¶è¢«è¦†ç›–ï¼Œç°åœ¨ä½ çŸ¥é“ä¸ºå•¥æˆ‘æ¨èè‡ªå·±cloneä»“åº“äº†å§ï¼ˆ

CCXCå‰ç«¯éƒ¨åˆ†åŠŸèƒ½æ²¡æœ‰æ”¹å¹²å‡€ï¼Œåé¢å¦‚æœæœ‰ç©ºæˆ‘ä¼šå®Œå–„è¿™ä¸€éƒ¨åˆ†ï¼Œä¸è¿‡æˆ‘å¯èƒ½æ²¡é‚£ä¹ˆæœ‰ç©ºï¼Œä½ ä¹Ÿå¯ä»¥åŠ æˆ‘qqæ¥é—®æˆ‘ï¼ˆ

## é¸£è°¢

æ„Ÿè°¢[Ted Zyzsdy](https://github.com/zyzsdy)å¤§ä½¬çš„å¸®åŠ©ã€‚

## æˆ‘è¿˜æ˜¯ä¸ä¼šï¼Œæ€ä¹ˆåŠï¼ï¼ï¼

åŠ æˆ‘QQ1668270511ï¼Œå¤‡æ³¨ï¼šCCXC *ï¼ˆä¸å¤‡æ³¨ä¸é€šè¿‡ï¼‰*

> [!TIP]
> æˆ‘ä»¬æ­£åœ¨ç­¹å»ºä¸€ä¸ªé¢„è®¡äº(å·²è·³ç¥¨å¾ˆä¹…)çš„CCBCçš„fanmadeèµ›äº‹ï¼Œå¦‚æœæ‚¨æœ‰å…´è¶£åŠ å…¥å‡ºé¢˜ç»„æˆ–è€…å†…æµ‹ç»„ï¼Œäº¦æˆ–è€…æ‚¨æœ‰ç¾å·¥æˆ–è€…è®¾è®¡æ–¹é¢çš„æ‰èƒ½ï¼Œæ¬¢è¿æ‚¨åŠ å…¥ï¼ç¾¤å·ï¼š[1061359082(ç‚¹å‡»åŠ ç¾¤)](https://qm.qq.com/q/wBLBM1kY9M)
